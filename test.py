import rfc3161ng

certificate = open('resources/tsa.crt', 'rb').read()
rt = rfc3161ng.RemoteTimestamper('http://freetsa.osrg/tsr', certificate=certificate)
tst = b'0\x82\x05+\x06\t*\x86H\x86\xf7\r\x01\x07\x02\xa0\x82\x05\x1c0\x82\x05\x18\x02\x01\x031\x0f0\r\x06\t`\x86H\x01e\x03\x04\x02\x03\x05\x000\x82\x01r\x06\x0b*\x86H\x86\xf7\r\x01\t\x10\x01\x04\xa0\x82\x01a\x04\x82\x01]0\x82\x01Y\x02\x01\x01\x06\x04*\x03\x04\x010\x1f0\x07\x06\x05+\x0e\x03\x02\x1a\x04\x14\xaenM\x12\t\xf1{F\x05\x03\x90O\xad){1\xe9\xcfcb\x02\x04\x02\x91\xab4\x18\x0f20221117151422Z\x01\x01\xff\xa0\x82\x01\x11\xa4\x82\x01\r0\x82\x01\t1\x110\x0f\x06\x03U\x04\n\x13\x08Free TSA1\x0c0\n\x06\x03U\x04\x0b\x13\x03TSA1v0t\x06\x03U\x04\r\x13mThis certificate digitally signs documents and time stamp requests made using the freetsa.org online services1\x180\x16\x06\x03U\x04\x03\x13\x0fwww.freetsa.org1"0 \x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x13busilezas@gmail.com1\x120\x10\x06\x03U\x04\x07\x13\tWuerzburg1\x0b0\t\x06\x03U\x04\x06\x13\x02DE1\x0f0\r\x06\x03U\x04\x08\x13\x06Bayern1\x82\x03\x8a0\x82\x03\x86\x02\x01\x010\x81\xa30\x81\x951\x110\x0f\x06\x03U\x04\n\x13\x08Free TSA1\x100\x0e\x06\x03U\x04\x0b\x13\x07Root CA1\x180\x16\x06\x03U\x04\x03\x13\x0fwww.freetsa.org1"0 \x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x13busilezas@gmail.com1\x120\x10\x06\x03U\x04\x07\x13\tWuerzburg1\x0f0\r\x06\x03U\x04\x08\x13\x06Bayern1\x0b0\t\x06\x03U\x04\x06\x13\x02DE\x02\t\x00\xc1\xe9\x86\x16\r\xa8\xe9\x820\r\x06\t`\x86H\x01e\x03\x04\x02\x03\x05\x00\xa0\x81\xb80\x1a\x06\t*\x86H\x86\xf7\r\x01\t\x031\r\x06\x0b*\x86H\x86\xf7\r\x01\t\x10\x01\x040\x1c\x06\t*\x86H\x86\xf7\r\x01\t\x051\x0f\x17\r221117151421Z0+\x06\x0b*\x86H\x86\xf7\r\x01\t\x10\x02\x0c1\x1c0\x1a0\x180\x16\x04\x14\x91m\xa3\xd8`\xec\xca\x82\xe3K\xc5\x9d\x17\x93\xe7\xe9h\x87_\x140O\x06\t*\x86H\x86\xf7\r\x01\t\x041B\x04@W-\xfd\x128\x95\x11p\xe2\xcf\xf8c)\xde\xa1\x19\xb3\x1d\x8d\x90\x07\x9f@:\xe03/\xff\xc9/\xba\xe2\xb9LA@\x95~\x1e\x7f\xeb\x1f\xb4\x10\xb6d\xcf\xd5ja\x7f\x15\xbe^/\xb4-\x03\xe1\xba\xd0\xc8\xfa\xcd0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x04\x82\x02\x002\xba\xec\x91\x0c\xf8\xd3\xe9/5\x06\xfdk\xcd\xbe\x13zXVa8\x8fL!\xa7\t\xa3\xe1\xc2\x1e\x84T"\x1dmo\xfd\xdb\x13\x06\x81\xedw\x83\x8bY-%w\xef\xb5\xd3*\x87pb\xe3E\x1b\xc4\x85\xab\x84\x8e]\xc1\x18\xe1F=\x8a\xa15\xc7\x16\xb2\x19w:,\x91p\x0ec\xffL\xeeC\xf6,Nw\xdfkG 8F\x96\xcb\xd7\xbb\xa0\x9bsO\xe6m\x87\x9c,QQ\xf9\x0f\x08\x89]`MH\xe0X\x8f\xa5\xa4\x12h_n\xad\xc4\x1d\x93\x05D\x19\xc4\xad\xea\x86\xed9\x8f`\x7f" \xce\xd6\xbaE\xaa\xdd\x1f\xc8\xc2\x13K\xfb\xacSDO\x88\xc5]8\x8d(?-\xfe:x2\xf3\x9b3\xac\xd3,!\xd3\x99\x85\x9d\x03e\x02\xe7\x90\x8f\x9b4r\xdd\xe7/#\tR\x15\xc5\\\x13\x01\xd1\xe6\xb8\x9cg\xb75Qz@\xfe\xf0\xd9\xebw%\xb1\xa3\xf9\xe6\x94\xb0\x08(p\x9c\xac;#oi\x1fz\xc4\x03\xc37\xa7\xd6\x01\x9f\xc1f\xf3&B@4\xfd\xa1\xbf\xc4>r\xcc\x17\x916@\xce\x08\x90\xb7b\x12|S\xfb\xeakiV\xb8p\xf0\x9f)8\xf2\xb5\xfb=\xfd\x13\xe1]\xf5\xfa\x0e\x95\xc9E\x12\xef\xd9\xd9\x8d:3_\xbe=Z\xb2Rh8c$;\xcf\xc4(\xa3\xffb.\xff\xf7\xe1\xf4\x01\xa1E\x91\xb3\x05w]\xf2k!\x8e )\xba\x07\xcc\x9c\x1agxds\xc2\xab8\x90\x00\x89M\xbe\xd20\xb8n$;\xb1\x03\x8e\x80\xf2;H+hPe\x13\x94HQg\x98\xed\xc1\xcf\x19\xa9\x7f\x8d\x00\x00\xb7&\x03\x97\xbd,\x89\xb6\xd2!\xf7\x7fy\x9bD\xa7\xfb\x84\x97K\xefG \xbdiRI\xc9[m\xd7\x88\x8f\xfe\xc7D\xe4-\x12h\xce.\x81\xc5t\x19\x02-e[\x14\x0b\x07-\xaa1\xdb\x9d\xe0\x8c\x10\xdfn#\xda\x85\xef\x9f\xf6\x91\x92\x15K\x8a\x91\xb0\'\x1bo8\xe0\x0c{\xbe&W\x99\x1a\xa3\xd6\xc6\xef\x0c\xcb/3[Jeo\x1b;\x80\xda\x1a\x08&=\xf0QN\nF}L\xc7\xa6\xa0\xe1S\xda'
print(rt.check(tst, data=b'John Doe'))
print(rfc3161ng.get_timestamp(tst))
